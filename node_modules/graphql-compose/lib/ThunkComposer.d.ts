import { isFunction } from 'graphql-compose/lib/utils/is';
import { GraphQLType } from 'graphql-compose/lib/graphql';
import { NamedTypeComposer } from 'graphql-compose/lib/utils/typeHelpers';
import { ListComposer } from 'graphql-compose/lib/ListComposer';
import { NonNullComposer } from 'graphql-compose/lib/NonNullComposer';
import { inspect } from 'graphql-compose/lib/utils/misc';
import { SchemaComposer } from 'graphql-compose/lib/SchemaComposer';

export class ThunkComposer<
  T extends NamedTypeComposer<any> = NamedTypeComposer<any>,
  G extends GraphQLType = GraphQLType
> {
  protected thunk: Function;
  protected typeName: string | void;
  protected _typeFromThunk: T | void;
  public ofType: T;

  constructor(thunk: Function, typeName?: string);

  public getUnwrappedTC(): T;

  public getType(): G;

  public getTypeName(): string;

  public getTypePlural(): ListComposer<ThunkComposer<T, G>>;

  public getTypeNonNull(): NonNullComposer<ThunkComposer<T, G>>;

  /**
   * Get Type wrapped in List modifier
   */
  public get List(): ListComposer<ThunkComposer<T, G>>;

  /**
   * Get Type wrapped in NonNull modifier
   */
  public get NonNull(): NonNullComposer<ThunkComposer<T, G>>;

  /**
   * Clone this type to another SchemaComposer.
   * Also will be clonned all wrapped types.
   */
  public cloneTo<TCtx = any>(
    anotherSchemaComposer: SchemaComposer<TCtx>,
    cloneMap?: Map<any, any>
  ): ThunkComposer<NamedTypeComposer<TCtx>, G>;
}
