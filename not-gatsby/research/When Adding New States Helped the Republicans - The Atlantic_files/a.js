_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[16],{"0+gX":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("fPoB");function a(e){var t=e.article,r=t.layout,a=t.isTnfCompatible;if("feature"===r||!a)throw new n.a}},4:function(e,t,r){r("j36g"),e.exports=r("4vwo")},"4vwo":function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[channel]/archive/[...article]",function(){return r("6eFE")}])},"6eFE":function(e,t,r){"use strict";r.r(t);var n=r("vJKn"),a=r.n(n),i=r("xvhg"),o=r("rg98"),l=r("jT3O"),u=r("q1tI"),c=r.n(u),s=r("Vvt1"),d=r.n(s),v=r("LZ9u"),p=r("gI8X"),f=r("XrP9"),w=r("fPoB"),b=r("0+gX"),g=c.a.createElement;function m(){var e=Object(l.a)(["\n  query ArticleInitialPropsQuery($id: ID!, $preview: String) {\n    article(id: $id, preview: $preview) {\n      id\n      isTnfCompatible\n      layout\n      hasMeter\n      url\n    }\n  }\n"]);return m=function(){return e},e}var h=d()((function(){return Promise.all([r.e(0),r.e(3),r.e(6),r.e(22)]).then(r.bind(null,"YUmz"))}),{ssr:!0,loadableGenerated:{webpack:function(){return["YUmz"]},modules:["components/article/Article"]}}),y=d()((function(){return Promise.all([r.e(0),r.e(3),r.e(6),r.e(23)]).then(r.bind(null,"X6Fy"))}),{ssr:!0,loadableGenerated:{webpack:function(){return["X6Fy"]},modules:["components/article/goose/GooseArticle"]}}),x=function(e){var t=e.layout,r=e.queryParams,n="feature"===t||(null===r||void 0===r?void 0:r.includes("duckling=swan"))&&!1;return g(v.a,{analyticsCategory:"story page"},g(n?h:y,null))},_=Object(p.a)(m());x.getInitialProps=function(){var e=Object(o.a)(a.a.mark((function e(t){var r,n,o,l,u,c,s,d,v,p,g,m,h,y,x,C,P,X,E,j;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urqlClient,o=t.query,l=t.req,u=t.res,c=o.article,s=Object(i.a)(c,4),s[0],s[1],s[2],d=s[3],v=new RegExp(/\/[a-z-]+\/archive\/\d{4}\/\d{2}\/[a-z\-\_\d]+\/\d+/i),null===l||void 0===l||!l.url){e.next=7;break}if(null===l||void 0===l||null===(p=l.url)||void 0===p?void 0:p.match(v)){e.next=7;break}throw new w.b;case 7:return g="string"===typeof o.preview?o.preview:null,e.next=10,n.query(_,{id:d,preview:g}).toPromise();case 10:if(m=e.sent,u&&(u.setHeader("Surrogate-Key","article-id-".concat(d)),o.preview&&u.setHeader("Cache-Control","private, no-store, max-age=0")),!u||null===(r=m.data)||void 0===r||!r.article){e.next=22;break}return Object(b.a)(m.data),x=m.data.article,C=x.id.split(":")[1],P=(null===l||void 0===l||null===(h=l.url)||void 0===h?void 0:h.split(v)[1].slice(1))||"",o.preview||(u.setHeader("Cache-Control","s-maxage=180"),u.setHeader("Surrogate-Control","max-age=180, stale-while-revalidate=86400, stale-if-error=259200")),x.hasMeter&&(u.setHeader("X-Is-Metered","1"),u.setHeader("X-Meter-Content",C),X=new Date,E=Object(f.a)(X),u.setHeader("X-Meter-Expires",E.toUTCString())),j=x.url.split("theatlantic.com")[1],-1===(null===l||void 0===l||null===(y=l.url)||void 0===y?void 0:y.indexOf(j))&&(u.setHeader("Location","".concat(j).concat(P)),u.statusCode=302,u.end()),e.abrupt("return",{layout:x.layout,queryParams:P});case 22:return e.abrupt("return",{});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.default=Object(p.c)(x)}},[[4,1,2,0,4,5,7]]]);
//# sourceMappingURL=[...article]-8e1c8928ec30fbc52a05.js.map