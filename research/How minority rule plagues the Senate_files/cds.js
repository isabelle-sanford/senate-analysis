/*! TABOOLA-DEFAULT-VERSION-SNAPSHOT 2021-03-10 */

!function(n){try{var t="https://",e=["aHR0cHM6Ly90MS50YWJvb2xhLmNvbQ==","aHR0cHM6Ly90Mi50YWJvb2xhLmNvbQ==","aHR0cHM6Ly90My50YWJvb2xhLmNvbQ==","aHR0cHM6Ly90NC50YWJvb2xhLmNvbQ==","aHR0cHM6Ly90NS50YWJvb2xhLmNvbQ==","aHR0cHM6Ly90Ni50YWJvb2xhLmNvbQ==","aHR0cHM6Ly90Ny50YWJvb2xhLmNvbQ==","aHR0cHM6Ly90OC50YWJvb2xhLmNvbQ=="],r="aHR0cHM6Ly9waXBzLnRhYm9vbGEuY29t";n.TRC.cds={userId:null,getHttpsPrefix:function n(){return t},doNothing:function n(){return!0},safeGetTfaConfig:function t(e,r,s){var i=n._tfa&&n._tfa.config&&n._tfa.config.safeGet;return i?i(e,r,s):null},safeGetRboxConfig:function n(t){var e;return(TRCImpl?TRCImpl.global:{})[t]},prepareGenericRequest:function t(e,r){var s,i=new(n.XDomainRequest||n.XMLHttpRequest);return i.open(e,r),i.onload=this.doNothing,i.onerror=this.doNothing,i.onprogress=this.doNothing,i},getUserId:function t(){var e=n.TFASC&&n.TFASC.tfaUserId&&"function"==typeof n.TFASC.tfaUserId.getUserId?n.TFASC.tfaUserId.getUserId():null,r=n.TRC.pageManager&&"function"==typeof n.TRC.pageManager.getUserId?n.TRC.pageManager.getUserId():null;return e||r},sendFinalReq:function n(t){var e="".concat(this.getHttpsPrefix(),"cds.taboola.com?uid=").concat(this.userId),r;null!==t[0]&&(e+="&dnid=".concat(t[0])),null!==t[1]&&(e+="&uad=".concat(t[1])),this.prepareGenericRequest("GET",e).send()},sendSimpleReq:function n(){var t="".concat(this.getHttpsPrefix(),"cds.taboola.com?uid=").concat(this.userId),e;this.prepareGenericRequest("GET",t).send()},dnidRequestPerDomain:function n(t){var e=this;return new Promise(function(n,r){var s=window.atob(t),i=e.prepareGenericRequest("GET",s);i.onreadystatechange=function(){if(4===this.readyState)if(200===this.status){var t=i.responseText;t||__trcWarn("cds: error in ".concat(s," - status ").concat(this.status,", return null")),n(t)}else __trcWarn("cds: error in ".concat(s," - status ").concat(this.status,", return null")),n(null)},i.ontimeout=function(){__trcWarn("cds: error in ".concat(s," - timeout")),n(null)},i.send()})},sendDnidRequest:function n(){var t=this;return new Promise(function(n,r){if(t.safeGetTfaConfig("cds:send-dnid-req",!1)||t.safeGetRboxConfig("cds:send-dnid")){for(var s=[],i=0;i<e.length;i++)s.push(t.dnidRequestPerDomain(e[i]));n(Promise.all(s).then(function(n){return t.getDnidNumber(n)},function(){return null}))}else n(null)})},getDnidNumber:function n(t){for(var r="",s=0;s<e.length;s++){if(!t[s])return __trcWarn("cds: one or more domains return null"),null;r+=t[s]}return r},sendUadRequest:function t(){var e=this;return new Promise(function(t,s){if(e.safeGetTfaConfig("cds:send-uad-req",!1)||e.safeGetRboxConfig("cds:send-uad")){var i=e.prepareGenericRequest("GET",n.atob(r));i.onreadystatechange=function(){if(4===this.readyState)if(200===this.status){var n=i.responseText;n||__trcWarn("cds: error in pips - status ".concat(this.status,", return null")),t("NULL"!==n?n:null)}else __trcWarn("cds: error in pips - status ".concat(this.status,", return null")),t(null)},i.ontimeout=function(){__trcWarn("cds: error in pips - timeout"),t(null)},i.send()}else t(null)})},init:function t(){var e=this;n.TRC.cdsInitialized||(n.Promise?(this.userId=this.getUserId(),this.userId&&Promise.all([this.sendDnidRequest(),this.sendUadRequest()]).then(function(n){return e.sendFinalReq(n)},function(){return e.sendSimpleReq()}),n.TRC.cdsInitialized=!0):n.TRC.cdsInitialized=!0)}},n.TRC.cds.init()}catch(n){__trcError("Error running cds",n)}}(window);